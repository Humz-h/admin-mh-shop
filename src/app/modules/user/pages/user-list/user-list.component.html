<div class="user-management">
  <!-- Back to Dashboard Button -->
  <div class="back-navigation">
    <button class="btn btn-secondary" (click)="goBack()">
      ‚Üê Quay l·∫°i Dashboard
    </button>
  </div>

  <!-- Header Section -->
  <div class="page-header floating">
    <div class="header-content">
      <h1 class="page-title">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h1>
      <p class="page-subtitle">Qu·∫£n l√Ω t√†i kho·∫£n kh√°ch h√†ng v√† ph√¢n quy·ªÅn</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="refreshUsers()" title="L√†m m·ªõi d·ªØ li·ªáu">
        <span class="btn-icon">üîÑ</span>
        L√†m m·ªõi
      </button>
      <button class="btn btn-primary glow" (click)="openAddUserModal()">
        <span class="btn-icon">+</span>
        Th√™m ng∆∞·ªùi d√πng
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading && !showSkeleton">
    <div class="loading-spinner"></div>
    <p>ƒêang t·∫£i danh s√°ch ng∆∞·ªùi d√πng...</p>
  </div>

  <!-- Skeleton Loading -->
  <div class="skeleton-container" *ngIf="showSkeleton">
    <div class="skeleton-table">
      <div class="skeleton-header">
        <div class="skeleton-cell" *ngFor="let i of [1,2,3,4,5,6,7]"></div>
      </div>
      <div class="skeleton-row" *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]">
        <div class="skeleton-cell skeleton-text"></div>
        <div class="skeleton-cell skeleton-text"></div>
        <div class="skeleton-cell skeleton-text"></div>
        <div class="skeleton-cell skeleton-text"></div>
        <div class="skeleton-cell skeleton-badge"></div>
        <div class="skeleton-cell skeleton-date"></div>
        <div class="skeleton-cell skeleton-date"></div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="errorMessage && !loading && !showSkeleton">
    <div class="error-message">
      <span class="error-icon">‚ö†Ô∏è</span>
      <p>{{ errorMessage }}</p>
      <button class="btn btn-primary" (click)="loadCustomers()">Th·ª≠ l·∫°i</button>
    </div>
  </div>

  <!-- Users Table -->
  <div class="table-container" *ngIf="!loading && !errorMessage && !showSkeleton && customers.length > 0">
    <table class="users-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>T√™n ƒëƒÉng nh·∫≠p</th>
          <th>H·ªç t√™n</th>
          <th>Email</th>
          <th>S·ªë ƒëi·ªán tho·∫°i</th>
          <th>Vai tr√≤</th>
          <th>Ng√†y t·∫°o</th>
          <th>Ng√†y c·∫≠p nh·∫≠t</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let customer of customers; trackBy: trackByUserId">
          <td class="user-id">{{ customer.id }}</td>
          <td class="user-username">
            <span class="username">{{ customer.username }}</span>
          </td>
          <td class="user-fullname">
            <span class="fullname">{{ customer.fullName || '-' }}</span>
          </td>
          <td class="user-email">
            <span class="email">{{ customer.email }}</span>
          </td>
          <td class="user-phone">
            <span class="phone">{{ customer.phone || '-' }}</span>
          </td>
          <td class="user-role">
            <span class="role-badge" [ngClass]="getRoleClass(customer.role)">
              {{ getRoleText(customer.role) }}
            </span>
          </td>
          <td class="user-date">{{ formatDate(customer.createdAt) }}</td>
          <td class="user-date">{{ formatDate(customer.updatedAt) }}</td>
          <td class="user-actions">
            <div class="action-buttons">
              <button class="btn-action btn-edit" (click)="editUser(customer)" title="Ch·ªânh s·ª≠a">
                ‚úèÔ∏è
              </button>
              <button class="btn-action btn-delete" (click)="deleteUser(customer)" title="X√≥a">
                üóëÔ∏è
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty state -->
  <div class="empty-state" *ngIf="!loading && !errorMessage && !showSkeleton && customers.length === 0">
    <div class="empty-message">
      <span class="empty-icon">üë•</span>
      <p>Kh√¥ng c√≥ d·ªØ li·ªáu ng∆∞·ªùi d√πng</p>
    </div>
  </div>

  <!-- User Insert/Edit Modal -->
  <app-user-insert-edit
    *ngIf="showModal || selectedCustomer"
    [showModal]="showModal"
    [isEditing]="isEditing"
    [selectedCustomer]="selectedCustomer"
    (modalClosed)="onModalClosed()"
    (customerSaved)="onCustomerSaved()">
  </app-user-insert-edit>
</div>

